(()=>{var Se=(w=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(w,{get:(a,n)=>(typeof require<"u"?require:a)[n]}):w)(function(w){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+w+'" is not supported')});var q=class w{static base64={decode(a,n=!1){n&&(a=a.replace(/-/g,"+").replace(/_/g,"/"),a=a.padEnd(a.length+(4-a.length%4)%4,"="));let o=self.atob(a);return Uint8Array.from(o,s=>s.charCodeAt(0))},encode(a,n=!1){let o=self.btoa(String.fromCharCode(...new Uint8Array(a)));return n?o.replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""):o}};static base32={decode(a){let n="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",o=[],s=0,c=0;for(let f of a){let i=n.indexOf(f);i!==-1&&(s=s<<5|i,c+=5,c>=8&&(o.push(s>>c-8&255),c-=8))}return new Uint8Array(o)},encode(a){let n="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",o="",s=0,c=0;for(let f of a)for(s=s<<8|f,c+=8;c>=5;)o+=n[s>>c-5&31],c-=5;return c>0&&(o+=n[s<<5-c&31]),o}};static hex={_hex(a){return a.match(/.{1,2}/g).map(n=>String.fromCharCode(parseInt(n,16))).join("")},hex_(a){return Array.from(a).map(n=>n.charCodeAt(0).toString(16).padStart(2,"0")).join("")},decode(a){if(a=a.replace(/\s+/g,"").toLowerCase(),a.length%2!==0)throw new Error("Hex string must have an even length");let n=a.length/2,o=new Uint8Array(n);for(let s=0;s<n;s++)o[s]=parseInt(a.substr(s*2,2),16);return o},encode(a){return Array.from(a).map(n=>n.toString(16).padStart(2,"0")).join("")}};static txt={from(a){return new TextEncoder().encode(a)},to(a){return new TextDecoder().decode(a)},base64_(a){let n=new TextEncoder().encode(a);return Buffer.base64._bytes(n)},_base64(a){let n=Buffer.base64.bytes_(a);return new TextDecoder().decode(n)},Uint16_(a){let n=typeof a=="string"?this.bytes_(a):a,o=n.length,s=o+o%2,c=new Uint16Array(s/2);for(let f=0;f<o;f+=2)c[f/2]=(n[f]|n[f+1]<<8)>>>0;return c}};static bigint={decode(a){let n=Math.ceil(a.toString(2).length/8),o=new Uint8Array(n);for(let s=0;s<n;s++)o[s]=Number(a&255n),a>>=8n;return o.reverse()},encode(a){let n=0n,o=a.length;for(let s=0;s<o;s++)n=n<<8n|BigInt(a[s]);return n}};static pem={encode(a,n){let o=w.base64.encode(a);return`-----BEGIN ${n}-----
${o}
-----END ${n}-----`}};static merge(a,n){let o=0;for(let f of a)o+=f.length;let s;switch(n){case 8:s=new Uint8Array(o);break;case 16:s=new Uint16Array(o);break;case 32:s=new Uint32Array(o);break;default:throw new Error("Invalid size")}let c=0;for(let f of a)s.set(f,c),c+=f.length;return s}static compare(a,n){if(a.length!==n.length)return!1;let o=0;for(let s=0;s<a.length;s++)o|=a[s]^n[s];return o===0}};var ue=class{static encoding(a,n){switch(n){case"hex":return q.hex.encode(a);case"base64":return q.base64.encode(a);case"base62":return q.base62.encode(a);case"base64url":return q.base64.encode(a,!0);case"base32":return q.base32.encode(a);default:return a}}static random_bytes(a,n=null){let o=self.crypto.getRandomValues(new Uint8Array(a));return this.encoding(o,n)}static random_ratio(){return self.crypto.getRandomValues(new Uint32Array(1))[0]/4294967296}static random_alphanumeric_code(a=20,n="-"){let o="ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",s="";for(let c=0;c<a;c++)s+=o[Math.floor(this.random_ratio()*o.length)];return n?s.match(/.{1,4}/g).join(n):s}static async hmac(a,n,o={}){let s=a instanceof Uint8Array?a:new TextEncoder().encode(a),c=await self.crypto.subtle.importKey("raw",n,{name:"HMAC",hash:{name:o.algo||"SHA-256"}},!1,["sign"]),f=await self.crypto.subtle.sign("HMAC",c,s);return this.encoding(new Uint8Array(f),o.encoding)}static async hash(a,n={}){let o=await self.crypto.subtle.digest({name:n.algorithm||"SHA-256"},a instanceof Uint8Array?a:new TextEncoder().encode(a));return this.encoding(new Uint8Array(o),n.encoding)}static async HKDF(a,n,o=new Uint8Array,s=256){let c=await self.crypto.subtle.importKey("raw",a,{name:"HKDF"},!1,["deriveKey"]),f=await self.crypto.subtle.deriveKey({name:"HKDF",salt:n,info:o,hash:"SHA-256"},c,{name:"AES-GCM",length:s},!0,["encrypt","decrypt"]);return new Uint8Array(await self.crypto.subtle.exportKey("raw",f))}static async deriveKey(a,n,o=1e5,s=32){let c=a instanceof Uint8Array?a:new TextEncoder().encode(a),f=await self.crypto.subtle.importKey("raw",c,{name:"PBKDF2"},!1,["deriveKey"]),i=await self.crypto.subtle.deriveKey({name:"PBKDF2",salt:n,iterations:o,hash:"SHA-256"},f,{name:"AES-GCM",length:s*8},!0,["encrypt","decrypt"]);return new Uint8Array(await self.crypto.subtle.exportKey("raw",i))}static truncateBuffer(a,n,o="start"){if(!(a instanceof Uint8Array))throw new TypeError("Expected a Uint8Array");if(n>=a.length)return a;switch(o){case"start":return a.slice(0,n);case"end":return a.slice(a.length-n);case"middle":{let s=Math.floor((a.length-n)/2);return a.slice(s,s+n)}case"smart":{let s=Math.floor(n/2),c=a.slice(0,s),f=a.slice(a.length-(n-s)),i=new Uint8Array(n);return i.set(c),i.set(f,s),i}default:throw new Error(`Unknown truncation mode: ${o}`)}}static async generate_key_pair(a,n=2048,o=!1){let s;switch(a){case"RSA":s={name:"RSA-OAEP",modulusLength:n,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}};break;case"ECDSA":s={name:"ECDSA",namedCurve:"P-256"};break;default:return-1}try{let c=a==="RSA"?["encrypt","decrypt"]:["sign","verify"],f=await self.crypto.subtle.generateKey(s,!0,c),i=await self.crypto.subtle.exportKey("spki",f.publicKey),y=await self.crypto.subtle.exportKey("pkcs8",f.privateKey);return{public:o?q.pem.encode(i,"PUBLIC KEY"):i,private:o?q.pem.encode(y,"PRIVATE KEY"):y}}catch(c){throw console.warn("Error generating key pair",c),new Error("Error generating key pair")}}};(function(w){if(typeof exports=="object"&&typeof module<"u")module.exports=w();else if(typeof define=="function"&&define.amd)define([],w);else{var a;a=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this,a.msgpack=w()}})(function(){return function w(a,n,o){function s(i,y){if(!n[i]){if(!a[i]){var m=typeof Se=="function"&&Se;if(!y&&m)return m(i,!0);if(c)return c(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var d=n[i]={exports:{}};a[i][0].call(d.exports,function(p){var h=a[i][1][p];return s(h||p)},d,d.exports,w,a,n,o)}return n[i].exports}for(var c=typeof Se=="function"&&Se,f=0;f<o.length;f++)s(o[f]);return s}({1:[function(w,a,n){n.encode=w("./encode").encode,n.decode=w("./decode").decode,n.Encoder=w("./encoder").Encoder,n.Decoder=w("./decoder").Decoder,n.createCodec=w("./ext").createCodec,n.codec=w("./codec").codec},{"./codec":10,"./decode":12,"./decoder":13,"./encode":15,"./encoder":16,"./ext":20}],2:[function(w,a,n){(function(o){function s(c){return c&&c.isBuffer&&c}a.exports=s(typeof o<"u"&&o)||s(this.Buffer)||s(typeof window<"u"&&self.Buffer)||this.Buffer}).call(this,w("buffer").Buffer)},{buffer:29}],3:[function(w,a,n){function o(f,i){for(var y=this,m=i||(i|=0),l=f.length,d=0,p=0;p<l;)d=f.charCodeAt(p++),d<128?y[m++]=d:d<2048?(y[m++]=192|d>>>6,y[m++]=128|63&d):d<55296||d>57343?(y[m++]=224|d>>>12,y[m++]=128|d>>>6&63,y[m++]=128|63&d):(d=(d-55296<<10|f.charCodeAt(p++)-56320)+65536,y[m++]=240|d>>>18,y[m++]=128|d>>>12&63,y[m++]=128|d>>>6&63,y[m++]=128|63&d);return m-i}function s(f,i,y){var m=this,l=0|i;y||(y=m.length);for(var d="",p=0;l<y;)p=m[l++],p<128?d+=String.fromCharCode(p):((224&p)===192?p=(31&p)<<6|63&m[l++]:(240&p)===224?p=(15&p)<<12|(63&m[l++])<<6|63&m[l++]:(248&p)===240&&(p=(7&p)<<18|(63&m[l++])<<12|(63&m[l++])<<6|63&m[l++]),p>=65536?(p-=65536,d+=String.fromCharCode((p>>>10)+55296,(1023&p)+56320)):d+=String.fromCharCode(p));return d}function c(f,i,y,m){var l;y||(y=0),m||m===0||(m=this.length),i||(i=0);var d=m-y;if(f===this&&y<i&&i<m)for(l=d-1;l>=0;l--)f[l+i]=this[l+y];else for(l=0;l<d;l++)f[l+i]=this[l+y];return d}n.copy=c,n.toString=s,n.write=o},{}],4:[function(w,a,f){function o(i){return new Array(i)}function s(i){if(!c.isBuffer(i)&&c.isView(i))i=c.Uint8Array.from(i);else if(c.isArrayBuffer(i))i=new Uint8Array(i);else{if(typeof i=="string")return c.from.call(f,i);if(typeof i=="number")throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(i)}var c=w("./bufferish"),f=a.exports=o(0);f.alloc=o,f.concat=c.concat,f.from=s},{"./bufferish":8}],5:[function(w,a,i){function o(y){return new f(y)}function s(y){if(!c.isBuffer(y)&&c.isView(y))y=c.Uint8Array.from(y);else if(c.isArrayBuffer(y))y=new Uint8Array(y);else{if(typeof y=="string")return c.from.call(i,y);if(typeof y=="number")throw new TypeError('"value" argument must not be a number')}return f.from&&f.from.length!==1?f.from(y):new f(y)}var c=w("./bufferish"),f=c.global,i=a.exports=c.hasBuffer?o(0):[];i.alloc=c.hasBuffer&&f.alloc||o,i.concat=c.concat,i.from=s},{"./bufferish":8}],6:[function(w,a,n){function o(p,h,k,b){var E=y.isBuffer(this),P=y.isBuffer(p);if(E&&P)return this.copy(p,h,k,b);if(d||E||P||!y.isView(this)||!y.isView(p))return i.copy.call(this,p,h,k,b);var K=k||b!=null?s.call(this,k,b):this;return p.set(K,h),K.length}function s(p,h){var k=this.slice||!d&&this.subarray;if(k)return k.call(this,p,h);var b=y.alloc.call(this,h-p);return o.call(this,b,0,p,h),b}function c(p,h,k){var b=!l&&y.isBuffer(this)?this.toString:i.toString;return b.apply(this,arguments)}function f(p){function h(){var k=this[p]||i[p];return k.apply(this,arguments)}return h}var i=w("./buffer-lite");n.copy=o,n.slice=s,n.toString=c,n.write=f("write");var y=w("./bufferish"),m=y.global,l=y.hasBuffer&&"TYPED_ARRAY_SUPPORT"in m,d=l&&!m.TYPED_ARRAY_SUPPORT},{"./buffer-lite":3,"./bufferish":8}],7:[function(w,a,f){function o(i){return new Uint8Array(i)}function s(i){if(c.isView(i)){var y=i.byteOffset,m=i.byteLength;i=i.buffer,i.byteLength!==m&&(i.slice?i=i.slice(y,y+m):(i=new Uint8Array(i),i.byteLength!==m&&(i=Array.prototype.slice.call(i,y,y+m))))}else{if(typeof i=="string")return c.from.call(f,i);if(typeof i=="number")throw new TypeError('"value" argument must not be a number')}return new Uint8Array(i)}var c=w("./bufferish"),f=a.exports=c.hasArrayBuffer?o(0):[];f.alloc=o,f.concat=c.concat,f.from=s},{"./bufferish":8}],8:[function(w,a,n){function o(U){return typeof U=="string"?i.call(this,U):y(this).from(U)}function s(U){return y(this).alloc(U)}function c(U,Y){function G(X){Y+=X.length}function x(X){J+=T.copy.call(X,ie,J)}Y||(Y=0,Array.prototype.forEach.call(U,G));var V=this!==n&&this||U[0],ie=s.call(V,Y),J=0;return Array.prototype.forEach.call(U,x),ie}function f(U){return U instanceof ArrayBuffer||R(U)}function i(U){var Y=3*U.length,G=s.call(this,Y),x=T.write.call(G,U);return Y!==x&&(G=T.slice.call(G,0,x)),G}function y(U){return b(U)?K:E(U)?L:k(U)?P:p?K:h?L:P}function m(){return!1}function l(U,Y){return U="[object "+U+"]",function(G){return G!=null&&{}.toString.call(Y?G[Y]:G)===U}}var d=n.global=w("./buffer-global"),p=n.hasBuffer=d&&!!d.isBuffer,h=n.hasArrayBuffer=typeof ArrayBuffer<"u",k=n.isArray=w("isarray");n.isArrayBuffer=h?f:m;var b=n.isBuffer=p?d.isBuffer:m,E=n.isView=h?ArrayBuffer.isView||l("ArrayBuffer","buffer"):m;n.alloc=s,n.concat=c,n.from=o;var P=n.Array=w("./bufferish-array"),K=n.Buffer=w("./bufferish-buffer"),L=n.Uint8Array=w("./bufferish-uint8array"),T=n.prototype=w("./bufferish-proto"),R=l("ArrayBuffer")},{"./buffer-global":2,"./bufferish-array":4,"./bufferish-buffer":5,"./bufferish-proto":6,"./bufferish-uint8array":7,isarray:34}],9:[function(w,a,n){function o(d){return this instanceof o?(this.options=d,void this.init()):new o(d)}function s(d){for(var p in d)o.prototype[p]=c(o.prototype[p],d[p])}function c(d,p){function h(){return d.apply(this,arguments),p.apply(this,arguments)}return d&&p?h:d||p}function f(d){function p(h,k){return k(h)}return d=d.slice(),function(h){return d.reduce(p,h)}}function i(d){return m(d)?f(d):d}function y(d){return new o(d)}var m=w("isarray");n.createCodec=y,n.install=s,n.filter=i;var l=w("./bufferish");o.prototype.init=function(){var d=this.options;return d&&d.uint8array&&(this.bufferish=l.Uint8Array),this},n.preset=y({preset:!0})},{"./bufferish":8,isarray:34}],10:[function(w,a,n){w("./read-core"),w("./write-core"),n.codec={preset:w("./codec-base").preset}},{"./codec-base":9,"./read-core":22,"./write-core":25}],11:[function(w,a,n){function o(f){if(!(this instanceof o))return new o(f);if(f&&(this.options=f,f.codec)){var i=this.codec=f.codec;i.bufferish&&(this.bufferish=i.bufferish)}}n.DecodeBuffer=o;var s=w("./read-core").preset,c=w("./flex-buffer").FlexDecoder;c.mixin(o.prototype),o.prototype.codec=s,o.prototype.fetch=function(){return this.codec.decode(this)}},{"./flex-buffer":21,"./read-core":22}],12:[function(w,a,n){function o(c,f){var i=new s(f);return i.write(c),i.read()}n.decode=o;var s=w("./decode-buffer").DecodeBuffer},{"./decode-buffer":11}],13:[function(w,a,n){function o(f){return this instanceof o?void c.call(this,f):new o(f)}n.Decoder=o;var s=w("event-lite"),c=w("./decode-buffer").DecodeBuffer;o.prototype=new c,s.mixin(o.prototype),o.prototype.decode=function(f){arguments.length&&this.write(f),this.flush()},o.prototype.push=function(f){this.emit("data",f)},o.prototype.end=function(f){this.decode(f),this.emit("end")}},{"./decode-buffer":11,"event-lite":31}],14:[function(w,a,n){function o(f){if(!(this instanceof o))return new o(f);if(f&&(this.options=f,f.codec)){var i=this.codec=f.codec;i.bufferish&&(this.bufferish=i.bufferish)}}n.EncodeBuffer=o;var s=w("./write-core").preset,c=w("./flex-buffer").FlexEncoder;c.mixin(o.prototype),o.prototype.codec=s,o.prototype.write=function(f){this.codec.encode(this,f)}},{"./flex-buffer":21,"./write-core":25}],15:[function(w,a,n){function o(c,f){var i=new s(f);return i.write(c),i.read()}n.encode=o;var s=w("./encode-buffer").EncodeBuffer},{"./encode-buffer":14}],16:[function(w,a,n){function o(f){return this instanceof o?void c.call(this,f):new o(f)}n.Encoder=o;var s=w("event-lite"),c=w("./encode-buffer").EncodeBuffer;o.prototype=new c,s.mixin(o.prototype),o.prototype.encode=function(f){this.write(f),this.emit("data",this.read())},o.prototype.end=function(f){arguments.length&&this.encode(f),this.flush(),this.emit("end")}},{"./encode-buffer":14,"event-lite":31}],17:[function(w,a,n){function o(c,f){return this instanceof o?(this.buffer=s.from(c),void(this.type=f)):new o(c,f)}n.ExtBuffer=o;var s=w("./bufferish")},{"./bufferish":8}],18:[function(w,a,n){function o(h){h.addExtPacker(14,Error,[i,s]),h.addExtPacker(1,EvalError,[i,s]),h.addExtPacker(2,RangeError,[i,s]),h.addExtPacker(3,ReferenceError,[i,s]),h.addExtPacker(4,SyntaxError,[i,s]),h.addExtPacker(5,TypeError,[i,s]),h.addExtPacker(6,URIError,[i,s]),h.addExtPacker(10,RegExp,[f,s]),h.addExtPacker(11,Boolean,[c,s]),h.addExtPacker(12,String,[c,s]),h.addExtPacker(13,Date,[Number,s]),h.addExtPacker(15,Number,[c,s]),typeof Uint8Array<"u"&&(h.addExtPacker(17,Int8Array,d),h.addExtPacker(18,Uint8Array,d),h.addExtPacker(19,Int16Array,d),h.addExtPacker(20,Uint16Array,d),h.addExtPacker(21,Int32Array,d),h.addExtPacker(22,Uint32Array,d),h.addExtPacker(23,Float32Array,d),typeof Float64Array<"u"&&h.addExtPacker(24,Float64Array,d),typeof Uint8ClampedArray<"u"&&h.addExtPacker(25,Uint8ClampedArray,d),h.addExtPacker(26,ArrayBuffer,d),h.addExtPacker(29,DataView,d)),m.hasBuffer&&h.addExtPacker(27,l,m.from)}function s(h){return y||(y=w("./encode").encode),y(h)}function c(h){return h.valueOf()}function f(h){h=RegExp.prototype.toString.call(h).split("/"),h.shift();var k=[h.pop()];return k.unshift(h.join("/")),k}function i(h){var k={};for(var b in p)k[b]=h[b];return k}n.setExtPackers=o;var y,m=w("./bufferish"),l=m.global,d=m.Uint8Array.from,p={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1}},{"./bufferish":8,"./encode":15}],19:[function(w,a,n){function o(h){h.addExtUnpacker(14,[s,f(Error)]),h.addExtUnpacker(1,[s,f(EvalError)]),h.addExtUnpacker(2,[s,f(RangeError)]),h.addExtUnpacker(3,[s,f(ReferenceError)]),h.addExtUnpacker(4,[s,f(SyntaxError)]),h.addExtUnpacker(5,[s,f(TypeError)]),h.addExtUnpacker(6,[s,f(URIError)]),h.addExtUnpacker(10,[s,c]),h.addExtUnpacker(11,[s,i(Boolean)]),h.addExtUnpacker(12,[s,i(String)]),h.addExtUnpacker(13,[s,i(Date)]),h.addExtUnpacker(15,[s,i(Number)]),typeof Uint8Array<"u"&&(h.addExtUnpacker(17,i(Int8Array)),h.addExtUnpacker(18,i(Uint8Array)),h.addExtUnpacker(19,[y,i(Int16Array)]),h.addExtUnpacker(20,[y,i(Uint16Array)]),h.addExtUnpacker(21,[y,i(Int32Array)]),h.addExtUnpacker(22,[y,i(Uint32Array)]),h.addExtUnpacker(23,[y,i(Float32Array)]),typeof Float64Array<"u"&&h.addExtUnpacker(24,[y,i(Float64Array)]),typeof Uint8ClampedArray<"u"&&h.addExtUnpacker(25,i(Uint8ClampedArray)),h.addExtUnpacker(26,y),h.addExtUnpacker(29,[y,i(DataView)])),l.hasBuffer&&h.addExtUnpacker(27,i(d))}function s(h){return m||(m=w("./decode").decode),m(h)}function c(h){return RegExp.apply(null,h)}function f(h){return function(k){var b=new h;for(var E in p)b[E]=k[E];return b}}function i(h){return function(k){return new h(k)}}function y(h){return new Uint8Array(h).buffer}n.setExtUnpackers=o;var m,l=w("./bufferish"),d=l.global,p={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1}},{"./bufferish":8,"./decode":12}],20:[function(w,a,n){w("./read-core"),w("./write-core"),n.createCodec=w("./codec-base").createCodec},{"./codec-base":9,"./read-core":22,"./write-core":25}],21:[function(w,a,n){function o(){if(!(this instanceof o))return new o}function s(){if(!(this instanceof s))return new s}function c(){function P(T){var R=this.offset?h.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=R?T?this.bufferish.concat([R,T]):R:T,this.offset=0}function K(){for(;this.offset<this.buffer.length;){var T,R=this.offset;try{T=this.fetch()}catch(U){if(U&&U.message!=E)throw U;this.offset=R;break}this.push(T)}}function L(T){var R=this.offset,U=R+T;if(U>this.buffer.length)throw new Error(E);return this.offset=U,R}return{bufferish:h,write:P,fetch:y,flush:K,push:l,pull:d,read:m,reserve:L,offset:0}}function f(){function P(){var U=this.start;if(U<this.offset){var Y=this.start=this.offset;return h.prototype.slice.call(this.buffer,U,Y)}}function K(){for(;this.start<this.offset;){var U=this.fetch();U&&this.push(U)}}function L(){var U=this.buffers||(this.buffers=[]),Y=U.length>1?this.bufferish.concat(U):U[0];return U.length=0,Y}function T(U){var Y=0|U;if(this.buffer){var G=this.buffer.length,x=0|this.offset,V=x+Y;if(V<G)return this.offset=V,x;this.flush(),U=Math.max(U,Math.min(2*G,this.maxBufferSize))}return U=Math.max(U,this.minBufferSize),this.buffer=this.bufferish.alloc(U),this.start=0,this.offset=Y,0}function R(U){var Y=U.length;if(Y>this.minBufferSize)this.flush(),this.push(U);else{var G=this.reserve(Y);h.prototype.copy.call(U,this.buffer,G)}}return{bufferish:h,write:i,fetch:P,flush:K,push:l,pull:L,read:m,reserve:T,send:R,maxBufferSize:b,minBufferSize:k,offset:0,start:0}}function i(){throw new Error("method not implemented: write()")}function y(){throw new Error("method not implemented: fetch()")}function m(){var P=this.buffers&&this.buffers.length;return P?(this.flush(),this.pull()):this.fetch()}function l(P){var K=this.buffers||(this.buffers=[]);K.push(P)}function d(){var P=this.buffers||(this.buffers=[]);return P.shift()}function p(P){function K(L){for(var T in P)L[T]=P[T];return L}return K}n.FlexDecoder=o,n.FlexEncoder=s;var h=w("./bufferish"),k=2048,b=65536,E="BUFFER_SHORTAGE";o.mixin=p(c()),o.mixin(o.prototype),s.mixin=p(f()),s.mixin(s.prototype)},{"./bufferish":8}],22:[function(w,a,n){function o(p){function h(b){var E=m(b),P=k[E];if(!P)throw new Error("Invalid type: "+(E&&"0x"+E.toString(16)));return P(b)}var k=l.getReadToken(p);return h}function s(){var p=this.options;return this.decode=o(p),p&&p.preset&&y.setExtUnpackers(this),this}function c(p,h){var k=this.extUnpackers||(this.extUnpackers=[]);k[p]=d.filter(h)}function f(p){function h(b){return new i(b,p)}var k=this.extUnpackers||(this.extUnpackers=[]);return k[p]||h}var i=w("./ext-buffer").ExtBuffer,y=w("./ext-unpacker"),m=w("./read-format").readUint8,l=w("./read-token"),d=w("./codec-base");d.install({addExtUnpacker:c,getExtUnpacker:f,init:s}),n.preset=s.call(d.preset)},{"./codec-base":9,"./ext-buffer":17,"./ext-unpacker":19,"./read-format":23,"./read-token":24}],23:[function(w,a,n){function o(A){var B=J.hasArrayBuffer&&A&&A.binarraybuffer,_=A&&A.int64,W=j&&A&&A.usemap,N={map:W?c:s,array:f,str:i,bin:B?m:y,ext:l,uint8:d,uint16:h,uint32:b,uint64:P(8,_?T:K),int8:p,int16:k,int32:E,int64:P(8,_?R:L),float32:P(4,U),float64:P(8,Y)};return N}function s(A,B){var _,W={},N=new Array(B),Z=new Array(B),ce=A.codec.decode;for(_=0;_<B;_++)N[_]=ce(A),Z[_]=ce(A);for(_=0;_<B;_++)W[N[_]]=Z[_];return W}function c(A,B){var _,W=new Map,N=new Array(B),Z=new Array(B),ce=A.codec.decode;for(_=0;_<B;_++)N[_]=ce(A),Z[_]=ce(A);for(_=0;_<B;_++)W.set(N[_],Z[_]);return W}function f(A,B){for(var _=new Array(B),W=A.codec.decode,N=0;N<B;N++)_[N]=W(A);return _}function i(A,B){var _=A.reserve(B),W=_+B;return X.toString.call(A.buffer,"utf-8",_,W)}function y(A,B){var _=A.reserve(B),W=_+B,N=X.slice.call(A.buffer,_,W);return J.from(N)}function m(A,B){var _=A.reserve(B),W=_+B,N=X.slice.call(A.buffer,_,W);return J.Uint8Array.from(N).buffer}function l(A,B){var _=A.reserve(B+1),W=A.buffer[_++],N=_+B,Z=A.codec.getExtUnpacker(W);if(!Z)throw new Error("Invalid ext type: "+(W&&"0x"+W.toString(16)));var ce=X.slice.call(A.buffer,_,N);return Z(ce)}function d(A){var B=A.reserve(1);return A.buffer[B]}function p(A){var B=A.reserve(1),_=A.buffer[B];return 128&_?_-256:_}function h(A){var B=A.reserve(2),_=A.buffer;return _[B++]<<8|_[B]}function k(A){var B=A.reserve(2),_=A.buffer,W=_[B++]<<8|_[B];return 32768&W?W-65536:W}function b(A){var B=A.reserve(4),_=A.buffer;return 16777216*_[B++]+(_[B++]<<16)+(_[B++]<<8)+_[B]}function E(A){var B=A.reserve(4),_=A.buffer;return _[B++]<<24|_[B++]<<16|_[B++]<<8|_[B]}function P(A,B){return function(_){var W=_.reserve(A);return B.call(_.buffer,W,C)}}function K(A){return new V(this,A).toNumber()}function L(A){return new ie(this,A).toNumber()}function T(A){return new V(this,A)}function R(A){return new ie(this,A)}function U(A){return G.read(this,A,!1,23,4)}function Y(A){return G.read(this,A,!1,52,8)}var G=w("ieee754"),x=w("int64-buffer"),V=x.Uint64BE,ie=x.Int64BE;n.getReadFormat=o,n.readUint8=d;var J=w("./bufferish"),X=w("./bufferish-proto"),j=typeof Map<"u",C=!0},{"./bufferish":8,"./bufferish-proto":6,ieee754:32,"int64-buffer":33}],24:[function(w,a,n){function o(l){var d=m.getReadFormat(l);return l&&l.useraw?c(d):s(d)}function s(l){var d,p=new Array(256);for(d=0;d<=127;d++)p[d]=f(d);for(d=128;d<=143;d++)p[d]=y(d-128,l.map);for(d=144;d<=159;d++)p[d]=y(d-144,l.array);for(d=160;d<=191;d++)p[d]=y(d-160,l.str);for(p[192]=f(null),p[193]=null,p[194]=f(!1),p[195]=f(!0),p[196]=i(l.uint8,l.bin),p[197]=i(l.uint16,l.bin),p[198]=i(l.uint32,l.bin),p[199]=i(l.uint8,l.ext),p[200]=i(l.uint16,l.ext),p[201]=i(l.uint32,l.ext),p[202]=l.float32,p[203]=l.float64,p[204]=l.uint8,p[205]=l.uint16,p[206]=l.uint32,p[207]=l.uint64,p[208]=l.int8,p[209]=l.int16,p[210]=l.int32,p[211]=l.int64,p[212]=y(1,l.ext),p[213]=y(2,l.ext),p[214]=y(4,l.ext),p[215]=y(8,l.ext),p[216]=y(16,l.ext),p[217]=i(l.uint8,l.str),p[218]=i(l.uint16,l.str),p[219]=i(l.uint32,l.str),p[220]=i(l.uint16,l.array),p[221]=i(l.uint32,l.array),p[222]=i(l.uint16,l.map),p[223]=i(l.uint32,l.map),d=224;d<=255;d++)p[d]=f(d-256);return p}function c(l){var d,p=s(l).slice();for(p[217]=p[196],p[218]=p[197],p[219]=p[198],d=160;d<=191;d++)p[d]=y(d-160,l.bin);return p}function f(l){return function(){return l}}function i(l,d){return function(p){var h=l(p);return d(p,h)}}function y(l,d){return function(p){return d(p,l)}}var m=w("./read-format");n.getReadToken=o},{"./read-format":23}],25:[function(w,a,n){function o(d){function p(k,b){var E=h[typeof b];if(!E)throw new Error('Unsupported type "'+typeof b+'": '+b);E(k,b)}var h=m.getWriteType(d);return p}function s(){var d=this.options;return this.encode=o(d),d&&d.preset&&y.setExtPackers(this),this}function c(d,p,h){function k(K){return h&&(K=h(K)),new i(K,d)}h=l.filter(h);var b=p.name;if(b&&b!=="Object"){var E=this.extPackers||(this.extPackers={});E[b]=k}else{var P=this.extEncoderList||(this.extEncoderList=[]);P.unshift([p,k])}}function f(d){var p=this.extPackers||(this.extPackers={}),h=d.constructor,k=h&&h.name&&p[h.name];if(k)return k;for(var b=this.extEncoderList||(this.extEncoderList=[]),E=b.length,P=0;P<E;P++){var K=b[P];if(h===K[0])return K[1]}}var i=w("./ext-buffer").ExtBuffer,y=w("./ext-packer"),m=w("./write-type"),l=w("./codec-base");l.install({addExtPacker:c,getExtPacker:f,init:s}),n.preset=s.call(l.preset)},{"./codec-base":9,"./ext-buffer":17,"./ext-packer":18,"./write-type":27}],26:[function(w,a,n){function o(x){return x&&x.uint8array?s():Y||T.hasBuffer&&x&&x.safe?f():c()}function s(){var x=c();return x[202]=l(202,4,h),x[203]=l(203,8,k),x}function c(){var x=L.slice();return x[196]=i(196),x[197]=y(197),x[198]=m(198),x[199]=i(199),x[200]=y(200),x[201]=m(201),x[202]=l(202,4,G.writeFloatBE||h,!0),x[203]=l(203,8,G.writeDoubleBE||k,!0),x[204]=i(204),x[205]=y(205),x[206]=m(206),x[207]=l(207,8,d),x[208]=i(208),x[209]=y(209),x[210]=m(210),x[211]=l(211,8,p),x[217]=i(217),x[218]=y(218),x[219]=m(219),x[220]=y(220),x[221]=m(221),x[222]=y(222),x[223]=m(223),x}function f(){var x=L.slice();return x[196]=l(196,1,R.prototype.writeUInt8),x[197]=l(197,2,R.prototype.writeUInt16BE),x[198]=l(198,4,R.prototype.writeUInt32BE),x[199]=l(199,1,R.prototype.writeUInt8),x[200]=l(200,2,R.prototype.writeUInt16BE),x[201]=l(201,4,R.prototype.writeUInt32BE),x[202]=l(202,4,R.prototype.writeFloatBE),x[203]=l(203,8,R.prototype.writeDoubleBE),x[204]=l(204,1,R.prototype.writeUInt8),x[205]=l(205,2,R.prototype.writeUInt16BE),x[206]=l(206,4,R.prototype.writeUInt32BE),x[207]=l(207,8,d),x[208]=l(208,1,R.prototype.writeInt8),x[209]=l(209,2,R.prototype.writeInt16BE),x[210]=l(210,4,R.prototype.writeInt32BE),x[211]=l(211,8,p),x[217]=l(217,1,R.prototype.writeUInt8),x[218]=l(218,2,R.prototype.writeUInt16BE),x[219]=l(219,4,R.prototype.writeUInt32BE),x[220]=l(220,2,R.prototype.writeUInt16BE),x[221]=l(221,4,R.prototype.writeUInt32BE),x[222]=l(222,2,R.prototype.writeUInt16BE),x[223]=l(223,4,R.prototype.writeUInt32BE),x}function i(x){return function(V,ie){var J=V.reserve(2),X=V.buffer;X[J++]=x,X[J]=ie}}function y(x){return function(V,ie){var J=V.reserve(3),X=V.buffer;X[J++]=x,X[J++]=ie>>>8,X[J]=ie}}function m(x){return function(V,ie){var J=V.reserve(5),X=V.buffer;X[J++]=x,X[J++]=ie>>>24,X[J++]=ie>>>16,X[J++]=ie>>>8,X[J]=ie}}function l(x,V,ie,J){return function(X,j){var C=X.reserve(V+1);X.buffer[C++]=x,ie.call(X.buffer,j,C,J)}}function d(x,V){new P(this,V,x)}function p(x,V){new K(this,V,x)}function h(x,V){b.write(this,x,V,!1,23,4)}function k(x,V){b.write(this,x,V,!1,52,8)}var b=w("ieee754"),E=w("int64-buffer"),P=E.Uint64BE,K=E.Int64BE,L=w("./write-uint8").uint8,T=w("./bufferish"),R=T.global,U=T.hasBuffer&&"TYPED_ARRAY_SUPPORT"in R,Y=U&&!R.TYPED_ARRAY_SUPPORT,G=T.hasBuffer&&R.prototype||{};n.getWriteToken=o},{"./bufferish":8,"./write-uint8":28,ieee754:32,"int64-buffer":33}],27:[function(w,a,n){function o(E){function P(S,I){var D=I?195:194;_[D](S,I)}function K(S,I){var D,$=0|I;return I!==$?(D=203,void _[D](S,I)):(D=-32<=$&&$<=127?255&$:0<=$?$<=255?204:$<=65535?205:206:-128<=$?208:-32768<=$?209:210,void _[D](S,$))}function L(S,I){var D=207;_[D](S,I.toArray())}function T(S,I){var D=211;_[D](S,I.toArray())}function R(S){return S<32?1:S<=255?2:S<=65535?3:5}function U(S){return S<32?1:S<=65535?3:5}function Y(S){function I(D,$){var ee=$.length,he=5+3*ee;D.offset=D.reserve(he);var ye=D.buffer,fe=S(ee),ge=D.offset+fe;ee=m.write.call(ye,$,ge);var me=S(ee);if(fe!==me){var F=ge+me-fe,O=ge+ee;m.copy.call(ye,ye,F,ge,O)}var H=me===1?160+ee:me<=3?215+me:219;_[H](D,ee),D.offset+=ee}return I}function G(S,I){if(I===null)return V(S,I);if(Z(I))return ce(S,I);if(s(I))return ie(S,I);if(f.isUint64BE(I))return L(S,I);if(i.isInt64BE(I))return T(S,I);var D=S.codec.getExtPacker(I);return D&&(I=D(I)),I instanceof p?j(S,I):void ve(S,I)}function x(S,I){return Z(I)?B(S,I):void G(S,I)}function V(S,I){var D=192;_[D](S,I)}function ie(S,I){var D=I.length,$=D<16?144+D:D<=65535?220:221;_[$](S,D);for(var ee=S.codec.encode,he=0;he<D;he++)ee(S,I[he])}function J(S,I){var D=I.length,$=D<255?196:D<=65535?197:198;_[$](S,D),S.send(I)}function X(S,I){J(S,new Uint8Array(I))}function j(S,I){var D=I.buffer,$=D.length,ee=b[$]||($<255?199:$<=65535?200:201);_[ee](S,$),d[I.type](S),S.send(D)}function C(S,I){var D=Object.keys(I),$=D.length,ee=$<16?128+$:$<=65535?222:223;_[ee](S,$);var he=S.codec.encode;D.forEach(function(ye){he(S,ye),he(S,I[ye])})}function A(S,I){if(!(I instanceof Map))return C(S,I);var D=I.size,$=D<16?128+D:D<=65535?222:223;_[$](S,D);var ee=S.codec.encode;I.forEach(function(he,ye,fe){ee(S,ye),ee(S,he)})}function B(S,I){var D=I.length,$=D<32?160+D:D<=65535?218:219;_[$](S,D),S.send(I)}var _=l.getWriteToken(E),W=E&&E.useraw,N=h&&E&&E.binarraybuffer,Z=N?y.isArrayBuffer:y.isBuffer,ce=N?X:J,we=k&&E&&E.usemap,ve=we?A:C,be={boolean:P,function:V,number:K,object:W?x:G,string:Y(W?U:R),symbol:V,undefined:V};return be}var s=w("isarray"),c=w("int64-buffer"),f=c.Uint64BE,i=c.Int64BE,y=w("./bufferish"),m=w("./bufferish-proto"),l=w("./write-token"),d=w("./write-uint8").uint8,p=w("./ext-buffer").ExtBuffer,h=typeof Uint8Array<"u",k=typeof Map<"u",b=[];b[1]=212,b[2]=213,b[4]=214,b[8]=215,b[16]=216,n.getWriteType=o},{"./bufferish":8,"./bufferish-proto":6,"./ext-buffer":17,"./write-token":26,"./write-uint8":28,"int64-buffer":33,isarray:34}],28:[function(w,a,n){function o(f){return function(i){var y=i.reserve(1);i.buffer[y]=f}}for(var s=n.uint8=new Array(256),c=0;c<=255;c++)s[c]=o(c)},{}],29:[function(w,a,n){(function(o){"use strict";function s(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},e.foo()===42&&typeof e.subarray=="function"&&e.subarray(1,1).byteLength===0}catch{return!1}}function c(){return i.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function f(e,t){if(c()<t)throw new RangeError("Invalid typed array length");return i.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=i.prototype):(e===null&&(e=new i(t)),e.length=t),e}function i(e,t,r){if(!(i.TYPED_ARRAY_SUPPORT||this instanceof i))return new i(e,t,r);if(typeof e=="number"){if(typeof t=="string")throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return y(this,e,t,r)}function y(e,t,r,u){if(typeof t=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer?k(e,t,r,u):typeof t=="string"?p(e,t,r):b(e,t)}function m(e){if(typeof e!="number")throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function l(e,t,r,u){return m(t),t<=0?f(e,t):r!==void 0?typeof u=="string"?f(e,t).fill(r,u):f(e,t).fill(r):f(e,t)}function d(e,t){if(m(t),e=f(e,t<0?0:0|E(t)),!i.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function p(e,t,r){if(typeof r=="string"&&r!==""||(r="utf8"),!i.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var u=0|K(t,r);e=f(e,u);var g=e.write(t,r);return g!==u&&(e=e.slice(0,g)),e}function h(e,t){var r=t.length<0?0:0|E(t.length);e=f(e,r);for(var u=0;u<r;u+=1)e[u]=255&t[u];return e}function k(e,t,r,u){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(u||0))throw new RangeError("'length' is out of bounds");return t=r===void 0&&u===void 0?new Uint8Array(t):u===void 0?new Uint8Array(t,r):new Uint8Array(t,r,u),i.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=i.prototype):e=h(e,t),e}function b(e,t){if(i.isBuffer(t)){var r=0|E(t.length);return e=f(e,r),e.length===0||t.copy(e,0,0,r),e}if(t){if(typeof ArrayBuffer<"u"&&t.buffer instanceof ArrayBuffer||"length"in t)return typeof t.length!="number"||me(t.length)?f(e,0):h(e,t);if(t.type==="Buffer"&&H(t.data))return h(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function E(e){if(e>=c())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+c().toString(16)+" bytes");return 0|e}function P(e){return+e!=e&&(e=0),i.alloc(+e)}function K(e,t){if(i.isBuffer(e))return e.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;typeof e!="string"&&(e=""+e);var r=e.length;if(r===0)return 0;for(var u=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return ee(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return fe(e).length;default:if(u)return ee(e).length;t=(""+t).toLowerCase(),u=!0}}function L(e,t,r){var u=!1;if((t===void 0||t<0)&&(t=0),t>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,t>>>=0,r<=t))return"";for(e||(e="utf8");;)switch(e){case"hex":return _(this,t,r);case"utf8":case"utf-8":return j(this,t,r);case"ascii":return A(this,t,r);case"latin1":case"binary":return B(this,t,r);case"base64":return X(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return W(this,t,r);default:if(u)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),u=!0}}function T(e,t,r){var u=e[t];e[t]=e[r],e[r]=u}function R(e,t,r,u,g){if(e.length===0)return-1;if(typeof r=="string"?(u=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=g?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(g)return-1;r=e.length-1}else if(r<0){if(!g)return-1;r=0}if(typeof t=="string"&&(t=i.from(t,u)),i.isBuffer(t))return t.length===0?-1:U(e,t,r,u,g);if(typeof t=="number")return t=255&t,i.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?g?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):U(e,[t],r,u,g);throw new TypeError("val must be string, number or Buffer")}function U(e,t,r,u,g){function v(Ce,De){return M===1?Ce[De]:Ce.readUInt16BE(De*M)}var M=1,te=e.length,se=t.length;if(u!==void 0&&(u=String(u).toLowerCase(),u==="ucs2"||u==="ucs-2"||u==="utf16le"||u==="utf-16le")){if(e.length<2||t.length<2)return-1;M=2,te/=2,se/=2,r/=2}var re;if(g){var ae=-1;for(re=r;re<te;re++)if(v(e,re)===v(t,ae===-1?0:re-ae)){if(ae===-1&&(ae=re),re-ae+1===se)return ae*M}else ae!==-1&&(re-=re-ae),ae=-1}else for(r+se>te&&(r=te-se),re=r;re>=0;re--){for(var le=!0,Ie=0;Ie<se;Ie++)if(v(e,re+Ie)!==v(t,Ie)){le=!1;break}if(le)return re}return-1}function Y(e,t,r,u){r=Number(r)||0;var g=e.length-r;u?(u=Number(u),u>g&&(u=g)):u=g;var v=t.length;if(v%2!==0)throw new TypeError("Invalid hex string");u>v/2&&(u=v/2);for(var M=0;M<u;++M){var te=parseInt(t.substr(2*M,2),16);if(isNaN(te))return M;e[r+M]=te}return M}function G(e,t,r,u){return ge(ee(t,e.length-r),e,r,u)}function x(e,t,r,u){return ge(he(t),e,r,u)}function V(e,t,r,u){return x(e,t,r,u)}function ie(e,t,r,u){return ge(fe(t),e,r,u)}function J(e,t,r,u){return ge(ye(t,e.length-r),e,r,u)}function X(e,t,r){return t===0&&r===e.length?F.fromByteArray(e):F.fromByteArray(e.slice(t,r))}function j(e,t,r){r=Math.min(e.length,r);for(var u=[],g=t;g<r;){var v=e[g],M=null,te=v>239?4:v>223?3:v>191?2:1;if(g+te<=r){var se,re,ae,le;switch(te){case 1:v<128&&(M=v);break;case 2:se=e[g+1],(192&se)===128&&(le=(31&v)<<6|63&se,le>127&&(M=le));break;case 3:se=e[g+1],re=e[g+2],(192&se)===128&&(192&re)===128&&(le=(15&v)<<12|(63&se)<<6|63&re,le>2047&&(le<55296||le>57343)&&(M=le));break;case 4:se=e[g+1],re=e[g+2],ae=e[g+3],(192&se)===128&&(192&re)===128&&(192&ae)===128&&(le=(15&v)<<18|(63&se)<<12|(63&re)<<6|63&ae,le>65535&&le<1114112&&(M=le))}}M===null?(M=65533,te=1):M>65535&&(M-=65536,u.push(M>>>10&1023|55296),M=56320|1023&M),u.push(M),g+=te}return C(u)}function C(e){var t=e.length;if(t<=z)return String.fromCharCode.apply(String,e);for(var r="",u=0;u<t;)r+=String.fromCharCode.apply(String,e.slice(u,u+=z));return r}function A(e,t,r){var u="";r=Math.min(e.length,r);for(var g=t;g<r;++g)u+=String.fromCharCode(127&e[g]);return u}function B(e,t,r){var u="";r=Math.min(e.length,r);for(var g=t;g<r;++g)u+=String.fromCharCode(e[g]);return u}function _(e,t,r){var u=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>u)&&(r=u);for(var g="",v=t;v<r;++v)g+=$(e[v]);return g}function W(e,t,r){for(var u=e.slice(t,r),g="",v=0;v<u.length;v+=2)g+=String.fromCharCode(u[v]+256*u[v+1]);return g}function N(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function Z(e,t,r,u,g,v){if(!i.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>g||t<v)throw new RangeError('"value" argument is out of bounds');if(r+u>e.length)throw new RangeError("Index out of range")}function ce(e,t,r,u){t<0&&(t=65535+t+1);for(var g=0,v=Math.min(e.length-r,2);g<v;++g)e[r+g]=(t&255<<8*(u?g:1-g))>>>8*(u?g:1-g)}function we(e,t,r,u){t<0&&(t=4294967295+t+1);for(var g=0,v=Math.min(e.length-r,4);g<v;++g)e[r+g]=t>>>8*(u?g:3-g)&255}function ve(e,t,r,u,g,v){if(r+u>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function be(e,t,r,u,g){return g||ve(e,t,r,4,34028234663852886e22,-34028234663852886e22),O.write(e,t,r,u,23,4),r+4}function S(e,t,r,u,g){return g||ve(e,t,r,8,17976931348623157e292,-17976931348623157e292),O.write(e,t,r,u,52,8),r+8}function I(e){if(e=D(e).replace(oe,""),e.length<2)return"";for(;e.length%4!==0;)e+="=";return e}function D(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function $(e){return e<16?"0"+e.toString(16):e.toString(16)}function ee(e,t){t=t||1/0;for(var r,u=e.length,g=null,v=[],M=0;M<u;++M){if(r=e.charCodeAt(M),r>55295&&r<57344){if(!g){if(r>56319){(t-=3)>-1&&v.push(239,191,189);continue}if(M+1===u){(t-=3)>-1&&v.push(239,191,189);continue}g=r;continue}if(r<56320){(t-=3)>-1&&v.push(239,191,189),g=r;continue}r=(g-55296<<10|r-56320)+65536}else g&&(t-=3)>-1&&v.push(239,191,189);if(g=null,r<128){if((t-=1)<0)break;v.push(r)}else if(r<2048){if((t-=2)<0)break;v.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;v.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;v.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return v}function he(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function ye(e,t){for(var r,u,g,v=[],M=0;M<e.length&&!((t-=2)<0);++M)r=e.charCodeAt(M),u=r>>8,g=r%256,v.push(g),v.push(u);return v}function fe(e){return F.toByteArray(I(e))}function ge(e,t,r,u){for(var g=0;g<u&&!(g+r>=t.length||g>=e.length);++g)t[g+r]=e[g];return g}function me(e){return e!==e}var F=w("base64-js"),O=w("ieee754"),H=w("isarray");n.Buffer=i,n.SlowBuffer=P,n.INSPECT_MAX_BYTES=50,i.TYPED_ARRAY_SUPPORT=o.TYPED_ARRAY_SUPPORT!==void 0?o.TYPED_ARRAY_SUPPORT:s(),n.kMaxLength=c(),i.poolSize=8192,i._augment=function(e){return e.__proto__=i.prototype,e},i.from=function(e,t,r){return y(null,e,t,r)},i.TYPED_ARRAY_SUPPORT&&(i.prototype.__proto__=Uint8Array.prototype,i.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&i[Symbol.species]===i&&Object.defineProperty(i,Symbol.species,{value:null,configurable:!0})),i.alloc=function(e,t,r){return l(null,e,t,r)},i.allocUnsafe=function(e){return d(null,e)},i.allocUnsafeSlow=function(e){return d(null,e)},i.isBuffer=function(e){return!(e==null||!e._isBuffer)},i.compare=function(e,t){if(!i.isBuffer(e)||!i.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,u=t.length,g=0,v=Math.min(r,u);g<v;++g)if(e[g]!==t[g]){r=e[g],u=t[g];break}return r<u?-1:u<r?1:0},i.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(e,t){if(!H(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return i.alloc(0);var r;if(t===void 0)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var u=i.allocUnsafe(t),g=0;for(r=0;r<e.length;++r){var v=e[r];if(!i.isBuffer(v))throw new TypeError('"list" argument must be an Array of Buffers');v.copy(u,g),g+=v.length}return u},i.byteLength=K,i.prototype._isBuffer=!0,i.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)T(this,t,t+1);return this},i.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)T(this,t,t+3),T(this,t+1,t+2);return this},i.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)T(this,t,t+7),T(this,t+1,t+6),T(this,t+2,t+5),T(this,t+3,t+4);return this},i.prototype.toString=function(){var e=0|this.length;return e===0?"":arguments.length===0?j(this,0,e):L.apply(this,arguments)},i.prototype.equals=function(e){if(!i.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||i.compare(this,e)===0},i.prototype.inspect=function(){var e="",t=n.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},i.prototype.compare=function(e,t,r,u,g){if(!i.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(t===void 0&&(t=0),r===void 0&&(r=e?e.length:0),u===void 0&&(u=0),g===void 0&&(g=this.length),t<0||r>e.length||u<0||g>this.length)throw new RangeError("out of range index");if(u>=g&&t>=r)return 0;if(u>=g)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,u>>>=0,g>>>=0,this===e)return 0;for(var v=g-u,M=r-t,te=Math.min(v,M),se=this.slice(u,g),re=e.slice(t,r),ae=0;ae<te;++ae)if(se[ae]!==re[ae]){v=se[ae],M=re[ae];break}return v<M?-1:M<v?1:0},i.prototype.includes=function(e,t,r){return this.indexOf(e,t,r)!==-1},i.prototype.indexOf=function(e,t,r){return R(this,e,t,r,!0)},i.prototype.lastIndexOf=function(e,t,r){return R(this,e,t,r,!1)},i.prototype.write=function(e,t,r,u){if(t===void 0)u="utf8",r=this.length,t=0;else if(r===void 0&&typeof t=="string")u=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t=0|t,isFinite(r)?(r=0|r,u===void 0&&(u="utf8")):(u=r,r=void 0)}var g=this.length-t;if((r===void 0||r>g)&&(r=g),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");u||(u="utf8");for(var v=!1;;)switch(u){case"hex":return Y(this,e,t,r);case"utf8":case"utf-8":return G(this,e,t,r);case"ascii":return x(this,e,t,r);case"latin1":case"binary":return V(this,e,t,r);case"base64":return ie(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return J(this,e,t,r);default:if(v)throw new TypeError("Unknown encoding: "+u);u=(""+u).toLowerCase(),v=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var z=4096;i.prototype.slice=function(e,t){var r=this.length;e=~~e,t=t===void 0?r:~~t,e<0?(e+=r,e<0&&(e=0)):e>r&&(e=r),t<0?(t+=r,t<0&&(t=0)):t>r&&(t=r),t<e&&(t=e);var u;if(i.TYPED_ARRAY_SUPPORT)u=this.subarray(e,t),u.__proto__=i.prototype;else{var g=t-e;u=new i(g,void 0);for(var v=0;v<g;++v)u[v]=this[v+e]}return u},i.prototype.readUIntLE=function(e,t,r){e=0|e,t=0|t,r||N(e,t,this.length);for(var u=this[e],g=1,v=0;++v<t&&(g*=256);)u+=this[e+v]*g;return u},i.prototype.readUIntBE=function(e,t,r){e=0|e,t=0|t,r||N(e,t,this.length);for(var u=this[e+--t],g=1;t>0&&(g*=256);)u+=this[e+--t]*g;return u},i.prototype.readUInt8=function(e,t){return t||N(e,1,this.length),this[e]},i.prototype.readUInt16LE=function(e,t){return t||N(e,2,this.length),this[e]|this[e+1]<<8},i.prototype.readUInt16BE=function(e,t){return t||N(e,2,this.length),this[e]<<8|this[e+1]},i.prototype.readUInt32LE=function(e,t){return t||N(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},i.prototype.readUInt32BE=function(e,t){return t||N(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},i.prototype.readIntLE=function(e,t,r){e=0|e,t=0|t,r||N(e,t,this.length);for(var u=this[e],g=1,v=0;++v<t&&(g*=256);)u+=this[e+v]*g;return g*=128,u>=g&&(u-=Math.pow(2,8*t)),u},i.prototype.readIntBE=function(e,t,r){e=0|e,t=0|t,r||N(e,t,this.length);for(var u=t,g=1,v=this[e+--u];u>0&&(g*=256);)v+=this[e+--u]*g;return g*=128,v>=g&&(v-=Math.pow(2,8*t)),v},i.prototype.readInt8=function(e,t){return t||N(e,1,this.length),128&this[e]?(255-this[e]+1)*-1:this[e]},i.prototype.readInt16LE=function(e,t){t||N(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},i.prototype.readInt16BE=function(e,t){t||N(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},i.prototype.readInt32LE=function(e,t){return t||N(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},i.prototype.readInt32BE=function(e,t){return t||N(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},i.prototype.readFloatLE=function(e,t){return t||N(e,4,this.length),O.read(this,e,!0,23,4)},i.prototype.readFloatBE=function(e,t){return t||N(e,4,this.length),O.read(this,e,!1,23,4)},i.prototype.readDoubleLE=function(e,t){return t||N(e,8,this.length),O.read(this,e,!0,52,8)},i.prototype.readDoubleBE=function(e,t){return t||N(e,8,this.length),O.read(this,e,!1,52,8)},i.prototype.writeUIntLE=function(e,t,r,u){if(e=+e,t=0|t,r=0|r,!u){var g=Math.pow(2,8*r)-1;Z(this,e,t,r,g,0)}var v=1,M=0;for(this[t]=255&e;++M<r&&(v*=256);)this[t+M]=e/v&255;return t+r},i.prototype.writeUIntBE=function(e,t,r,u){if(e=+e,t=0|t,r=0|r,!u){var g=Math.pow(2,8*r)-1;Z(this,e,t,r,g,0)}var v=r-1,M=1;for(this[t+v]=255&e;--v>=0&&(M*=256);)this[t+v]=e/M&255;return t+r},i.prototype.writeUInt8=function(e,t,r){return e=+e,t=0|t,r||Z(this,e,t,1,255,0),i.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},i.prototype.writeUInt16LE=function(e,t,r){return e=+e,t=0|t,r||Z(this,e,t,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):ce(this,e,t,!0),t+2},i.prototype.writeUInt16BE=function(e,t,r){return e=+e,t=0|t,r||Z(this,e,t,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):ce(this,e,t,!1),t+2},i.prototype.writeUInt32LE=function(e,t,r){return e=+e,t=0|t,r||Z(this,e,t,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):we(this,e,t,!0),t+4},i.prototype.writeUInt32BE=function(e,t,r){return e=+e,t=0|t,r||Z(this,e,t,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):we(this,e,t,!1),t+4},i.prototype.writeIntLE=function(e,t,r,u){if(e=+e,t=0|t,!u){var g=Math.pow(2,8*r-1);Z(this,e,t,r,g-1,-g)}var v=0,M=1,te=0;for(this[t]=255&e;++v<r&&(M*=256);)e<0&&te===0&&this[t+v-1]!==0&&(te=1),this[t+v]=(e/M>>0)-te&255;return t+r},i.prototype.writeIntBE=function(e,t,r,u){if(e=+e,t=0|t,!u){var g=Math.pow(2,8*r-1);Z(this,e,t,r,g-1,-g)}var v=r-1,M=1,te=0;for(this[t+v]=255&e;--v>=0&&(M*=256);)e<0&&te===0&&this[t+v+1]!==0&&(te=1),this[t+v]=(e/M>>0)-te&255;return t+r},i.prototype.writeInt8=function(e,t,r){return e=+e,t=0|t,r||Z(this,e,t,1,127,-128),i.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},i.prototype.writeInt16LE=function(e,t,r){return e=+e,t=0|t,r||Z(this,e,t,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):ce(this,e,t,!0),t+2},i.prototype.writeInt16BE=function(e,t,r){return e=+e,t=0|t,r||Z(this,e,t,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):ce(this,e,t,!1),t+2},i.prototype.writeInt32LE=function(e,t,r){return e=+e,t=0|t,r||Z(this,e,t,4,2147483647,-2147483648),i.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):we(this,e,t,!0),t+4},i.prototype.writeInt32BE=function(e,t,r){return e=+e,t=0|t,r||Z(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):we(this,e,t,!1),t+4},i.prototype.writeFloatLE=function(e,t,r){return be(this,e,t,!0,r)},i.prototype.writeFloatBE=function(e,t,r){return be(this,e,t,!1,r)},i.prototype.writeDoubleLE=function(e,t,r){return S(this,e,t,!0,r)},i.prototype.writeDoubleBE=function(e,t,r){return S(this,e,t,!1,r)},i.prototype.copy=function(e,t,r,u){if(r||(r=0),u||u===0||(u=this.length),t>=e.length&&(t=e.length),t||(t=0),u>0&&u<r&&(u=r),u===r||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(u<0)throw new RangeError("sourceEnd out of bounds");u>this.length&&(u=this.length),e.length-t<u-r&&(u=e.length-t+r);var g,v=u-r;if(this===e&&r<t&&t<u)for(g=v-1;g>=0;--g)e[g+t]=this[g+r];else if(v<1e3||!i.TYPED_ARRAY_SUPPORT)for(g=0;g<v;++g)e[g+t]=this[g+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+v),t);return v},i.prototype.fill=function(e,t,r,u){if(typeof e=="string"){if(typeof t=="string"?(u=t,t=0,r=this.length):typeof r=="string"&&(u=r,r=this.length),e.length===1){var g=e.charCodeAt(0);g<256&&(e=g)}if(u!==void 0&&typeof u!="string")throw new TypeError("encoding must be a string");if(typeof u=="string"&&!i.isEncoding(u))throw new TypeError("Unknown encoding: "+u)}else typeof e=="number"&&(e=255&e);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;t>>>=0,r=r===void 0?this.length:r>>>0,e||(e=0);var v;if(typeof e=="number")for(v=t;v<r;++v)this[v]=e;else{var M=i.isBuffer(e)?e:ee(new i(e,u).toString()),te=M.length;for(v=0;v<r-t;++v)this[v+t]=M[v%te]}return this};var oe=/[^+\/0-9A-Za-z-_]/g}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"base64-js":30,ieee754:32,isarray:34}],30:[function(w,a,n){"use strict";function o(b){var E=b.length;if(E%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return b[E-2]==="="?2:b[E-1]==="="?1:0}function s(b){return 3*b.length/4-o(b)}function c(b){var E,P,K,L,T,R,U=b.length;T=o(b),R=new d(3*U/4-T),K=T>0?U-4:U;var Y=0;for(E=0,P=0;E<K;E+=4,P+=3)L=l[b.charCodeAt(E)]<<18|l[b.charCodeAt(E+1)]<<12|l[b.charCodeAt(E+2)]<<6|l[b.charCodeAt(E+3)],R[Y++]=L>>16&255,R[Y++]=L>>8&255,R[Y++]=255&L;return T===2?(L=l[b.charCodeAt(E)]<<2|l[b.charCodeAt(E+1)]>>4,R[Y++]=255&L):T===1&&(L=l[b.charCodeAt(E)]<<10|l[b.charCodeAt(E+1)]<<4|l[b.charCodeAt(E+2)]>>2,R[Y++]=L>>8&255,R[Y++]=255&L),R}function f(b){return m[b>>18&63]+m[b>>12&63]+m[b>>6&63]+m[63&b]}function i(b,E,P){for(var K,L=[],T=E;T<P;T+=3)K=(b[T]<<16)+(b[T+1]<<8)+b[T+2],L.push(f(K));return L.join("")}function y(b){for(var E,P=b.length,K=P%3,L="",T=[],R=16383,U=0,Y=P-K;U<Y;U+=R)T.push(i(b,U,U+R>Y?Y:U+R));return K===1?(E=b[P-1],L+=m[E>>2],L+=m[E<<4&63],L+="=="):K===2&&(E=(b[P-2]<<8)+b[P-1],L+=m[E>>10],L+=m[E>>4&63],L+=m[E<<2&63],L+="="),T.push(L),T.join("")}n.byteLength=s,n.toByteArray=c,n.fromByteArray=y;for(var m=[],l=[],d=typeof Uint8Array<"u"?Uint8Array:Array,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,k=p.length;h<k;++h)m[h]=p[h],l[p.charCodeAt(h)]=h;l[45]=62,l[95]=63},{}],31:[function(w,a,n){function o(){if(!(this instanceof o))return new o}(function(s){function c(h){for(var k in p)h[k]=p[k];return h}function f(h,k){return l(this,h).push(k),this}function i(h,k){function b(){y.call(E,h,b),k.apply(this,arguments)}var E=this;return b.originalListener=k,l(E,h).push(b),E}function y(h,k){function b(K){return K!==k&&K.originalListener!==k}var E,P=this;if(arguments.length){if(k){if(E=l(P,h,!0)){if(E=E.filter(b),!E.length)return y.call(P,h);P[d][h]=E}}else if(E=P[d],E&&(delete E[h],!Object.keys(E).length))return y.call(P)}else delete P[d];return P}function m(h,k){function b(U){U.call(K)}function E(U){U.call(K,k)}function P(U){U.apply(K,R)}var K=this,L=l(K,h,!0);if(!L)return!1;var T=arguments.length;if(T===1)L.forEach(b);else if(T===2)L.forEach(E);else{var R=Array.prototype.slice.call(arguments,1);L.forEach(P)}return!!L.length}function l(h,k,b){if(!b||h[d]){var E=h[d]||(h[d]={});return E[k]||(E[k]=[])}}typeof a<"u"&&(a.exports=s);var d="listeners",p={on:f,once:i,off:y,emit:m};c(s.prototype),s.mixin=c})(o)},{}],32:[function(w,a,n){n.read=function(o,s,c,f,i){var y,m,l=8*i-f-1,d=(1<<l)-1,p=d>>1,h=-7,k=c?i-1:0,b=c?-1:1,E=o[s+k];for(k+=b,y=E&(1<<-h)-1,E>>=-h,h+=l;h>0;y=256*y+o[s+k],k+=b,h-=8);for(m=y&(1<<-h)-1,y>>=-h,h+=f;h>0;m=256*m+o[s+k],k+=b,h-=8);if(y===0)y=1-p;else{if(y===d)return m?NaN:(E?-1:1)*(1/0);m+=Math.pow(2,f),y-=p}return(E?-1:1)*m*Math.pow(2,y-f)},n.write=function(o,s,c,f,i,y){var m,l,d,p=8*y-i-1,h=(1<<p)-1,k=h>>1,b=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,E=f?0:y-1,P=f?1:-1,K=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(l=isNaN(s)?1:0,m=h):(m=Math.floor(Math.log(s)/Math.LN2),s*(d=Math.pow(2,-m))<1&&(m--,d*=2),s+=m+k>=1?b/d:b*Math.pow(2,1-k),s*d>=2&&(m++,d/=2),m+k>=h?(l=0,m=h):m+k>=1?(l=(s*d-1)*Math.pow(2,i),m+=k):(l=s*Math.pow(2,k-1)*Math.pow(2,i),m=0));i>=8;o[c+E]=255&l,E+=P,l/=256,i-=8);for(m=m<<i|l,p+=i;p>0;o[c+E]=255&m,E+=P,m/=256,p-=8);o[c+E-P]|=128*K}},{}],33:[function(w,a,n){(function(o){var s,c,f,i;(function(y){function m(j,C,A){function B(F,O,H,z){return this instanceof B?W(this,F,O,H,z):new B(F,O,H,z)}function _(F){return!(!F||!F[me])}function W(F,O,H,z,oe){if(G&&x&&(O instanceof x&&(O=new G(O)),z instanceof x&&(z=new G(z))),!(O||H||z||R))return void(F.buffer=b(V,0));if(!h(O,H)){var e=R||Array;oe=H,z=O,H=0,O=new e(8)}F.buffer=O,F.offset=H|=0,U!==typeof z&&(typeof z=="string"?N(O,H,z,oe||10):h(z,oe)?k(O,H,z,oe):typeof oe=="number"?(we(O,H+be,z),we(O,H+S,oe)):z>0?he(O,H,z):z<0?ye(O,H,z):k(O,H,V,0))}function N(F,O,H,z){var oe=0,e=H.length,t=0,r=0;H[0]==="-"&&oe++;for(var u=oe;oe<e;){var g=parseInt(H[oe++],z);if(!(g>=0))break;r=r*z+g,t=t*z+Math.floor(r/J),r%=J}u&&(t=~t,r?r=J-r:t++),we(F,O+be,t),we(F,O+S,r)}function Z(){var F=this.buffer,O=this.offset,H=ve(F,O+be),z=ve(F,O+S);return A||(H|=0),H?H*J+z:z}function ce(F){var O=this.buffer,H=this.offset,z=ve(O,H+be),oe=ve(O,H+S),e="",t=!A&&2147483648&z;for(t&&(z=~z,oe=J-oe),F=F||10;;){var r=z%F*J+oe;if(z=Math.floor(z/F),oe=Math.floor(r/F),e=(r%F).toString(F)+e,!z&&!oe)break}return t&&(e="-"+e),e}function we(F,O,H){F[O+ee]=255&H,H>>=8,F[O+$]=255&H,H>>=8,F[O+D]=255&H,H>>=8,F[O+I]=255&H}function ve(F,O){return F[O+I]*X+(F[O+D]<<16)+(F[O+$]<<8)+F[O+ee]}var be=C?0:4,S=C?4:0,I=C?0:3,D=C?1:2,$=C?2:1,ee=C?3:0,he=C?E:K,ye=C?P:L,fe=B.prototype,ge="is"+j,me="_"+ge;return fe.buffer=void 0,fe.offset=0,fe[me]=!0,fe.toNumber=Z,fe.toString=ce,fe.toJSON=Z,fe.toArray=l,Y&&(fe.toBuffer=d),G&&(fe.toArrayBuffer=p),B[ge]=_,y[j]=B,B}function l(j){var C=this.buffer,A=this.offset;return R=null,j!==!1&&A===0&&C.length===8&&ie(C)?C:b(C,A)}function d(j){var C=this.buffer,A=this.offset;if(R=Y,j!==!1&&A===0&&C.length===8&&o.isBuffer(C))return C;var B=new Y(8);return k(B,0,C,A),B}function p(j){var C=this.buffer,A=this.offset,B=C.buffer;if(R=G,j!==!1&&A===0&&B instanceof x&&B.byteLength===8)return B;var _=new G(8);return k(_,0,C,A),_.buffer}function h(j,C){var A=j&&j.length;return C|=0,A&&C+8<=A&&typeof j[C]!="string"}function k(j,C,A,B){C|=0,B|=0;for(var _=0;_<8;_++)j[C++]=255&A[B++]}function b(j,C){return Array.prototype.slice.call(j,C,C+8)}function E(j,C,A){for(var B=C+8;B>C;)j[--B]=255&A,A/=256}function P(j,C,A){var B=C+8;for(A++;B>C;)j[--B]=255&-A^255,A/=256}function K(j,C,A){for(var B=C+8;C<B;)j[C++]=255&A,A/=256}function L(j,C,A){var B=C+8;for(A++;C<B;)j[C++]=255&-A^255,A/=256}function T(j){return!!j&&Object.prototype.toString.call(j)=="[object Array]"}var R,U="undefined",Y=U!==typeof o&&o,G=U!==typeof Uint8Array&&Uint8Array,x=U!==typeof ArrayBuffer&&ArrayBuffer,V=[0,0,0,0,0,0,0,0],ie=Array.isArray||T,J=4294967296,X=16777216;s=m("Uint64BE",!0,!0),c=m("Int64BE",!0,!1),f=m("Uint64LE",!1,!0),i=m("Int64LE",!1,!1)})(typeof n=="object"&&typeof n.nodeName!="string"?n:this||{})}).call(this,w("buffer").Buffer)},{buffer:29}],34:[function(w,a,n){var o={}.toString;a.exports=Array.isArray||function(s){return o.call(s)=="[object Array]"}},{}]},{},[1])(1)});var de=msgpack;var ne=class w{static prefix="vve";static set(a,n){sessionStorage.setItem(`${w.prefix}-${a}`,q.base64.encode(de.encode(n)))}static get(a){try{let n=sessionStorage.getItem(`${w.prefix}-${a}`);return n?de.decode(q.base64.decode(n)):null}catch(n){return console.warn("[!] SessionStorage - get",n),null}}static remove(a){sessionStorage.removeItem(`${w.prefix}-${a}`)}};var Ee=class{static keyMap=new Map;static async resolve_key(a){if(a instanceof CryptoKey)return a;if(a instanceof Uint8Array&&a.length===32){let n=[...a].join("");if(this.keyMap.has(n))return this.keyMap.get(n);let o=await self.crypto.subtle.importKey("raw",a,{name:"AES-GCM"},!1,["encrypt","decrypt"]);return this.keyMap.set(n,o),o}throw new Error("Invalid key format. Expected 32-byte Uint8Array or CryptoKey.")}static async encrypt(a,n){let o=self.crypto.getRandomValues(new Uint8Array(12)),s=await this.resolve_key(n),c=await self.crypto.subtle.encrypt({name:"AES-GCM",iv:o},s,a),f=new Uint8Array(c);return new Uint8Array([...o,...f])}static async decrypt(a,n){let o=a.slice(0,12),s=a.slice(12),c=await this.resolve_key(n);try{let f=await self.crypto.subtle.decrypt({name:"AES-GCM",iv:o,tagLength:128},c,s);return new Uint8Array(f)}catch(f){throw new Error("Decryption failed: "+f.message)}}};var Q=class w{static prefix="vve";static key=null;static async set(a,n,o=null){o===1&&(o=this.key);let s=de.encode(n),c=o instanceof Uint8Array?await Ee.encrypt(s,o):s;localStorage.setItem(`${w.prefix}-${a}`,q.base64.encode(c))}static exist(a){return localStorage.getItem(`${w.prefix}-${a}`)!==null}static async get(a,n=null){n===1&&(n=this.key);try{let o=localStorage.getItem(`${w.prefix}-${a}`);if(!o)return null;let s=q.base64.decode(o),c=n instanceof Uint8Array?await Ee.decrypt(s,n):s;return de.decode(c)}catch(o){return console.warn("[!] LocalStorage - get",o),null}}static has(a){return localStorage.getItem(`${w.prefix}-${a}`)!==null}static remove(a){localStorage.removeItem(`${w.prefix}-${a}`)}};var Te=class{static dev=!1;static origin=this.dev?"http://localhost:3000":"https://vortexvault.fly.dev"};var ke=class{static async generate_keys(a="P-256"){let n=await self.self.crypto.subtle.generateKey({name:"ECDH",namedCurve:a},!0,["deriveKey","deriveBits"]),o=await self.self.crypto.subtle.exportKey("raw",n.publicKey),s=await self.self.crypto.subtle.exportKey("pkcs8",n.privateKey);return{public_key:[n.publicKey,new Uint8Array(o)],private_key:[n.privateKey,new Uint8Array(s)]}}static async import_public_key(a,n="P-256"){return await self.self.crypto.subtle.importKey("raw",a,{name:"ECDH",namedCurve:n},!0,[])}static async import_private_key(a,n="P-256"){return self.self.crypto.subtle.importKey("pkcs8",a,{name:"ECDH",namedCurve:n},!0,["deriveKey","deriveBits"])}static async derive_shared_secret(a,n){let o=await self.self.crypto.subtle.deriveBits({name:"ECDH",public:n},a,256);return new Uint8Array(o)}static async export_private_key(a){let n=await self.self.crypto.subtle.exportKey("pkcs8",a);return new Uint8Array(n)}};var Ae=class w{static recentKey=null;static clientPrivateKey=null;static clientPublicKey=null;static clientPublicKeyHex=null;static timeWindow=120;static async getIntegrity(a={}){let n=ne.get("shared-secret");if(!(n instanceof Uint8Array))return null;let o=ue.random_bytes(12),s=de.encode(a),c=q.merge([o,s],8),f=await this.deriveKey(n,o),i=await ue.hmac(c,f),y=q.merge([o,i],8);return q.base64.encode(y,!0)}static async generateKeyPair(){let a=await ke.generate_keys();return this.clientPrivateKey=a.private_key[0],this.clientPublicKey=a.public_key[0],this.clientPublicKeyHex=q.hex.encode(a.public_key[1]),this.clientPublicKeyHex}static async deriveSharedSecret(a){let n=await ke.import_public_key(q.hex.decode(a)),o=await ke.derive_shared_secret(this.clientPrivateKey,n);return await ue.hash(o)}static async deriveKey(a,n,o=w.timeWindow,s=0){let c=Math.floor((Date.now()/1e3+s*o)/o),f=new TextEncoder().encode(`${c}`);return await ue.HKDF(a,n,f)}static async completeHandshake(a){let n=await this.deriveSharedSecret(a);return n?(ne.set("shared-secret",n),n):!1}};var pe=class w{static recent={};static async fetch(a,n={},o={}){try{n.headers=n.headers||{},o.content_type=o.content_type||"json",o.return_type=o.return_type||"json",n.headers["x-client-type"]="extension",n.auth&&(n.headers["x-authentication-method"]=n.auth,delete n.auth);let s=await Ae.getIntegrity(n.body??{});switch(s&&(n.headers["X-Integrity"]=s),o.content_type){case"json":n.headers["Content-Type"]=n.headers["Content-Type"]||"application/json",n.body=JSON.stringify(n.body);break;case"form-data":n.headers["Content-Type"]=n.headers["Content-Type"]||"multipart/form-data",n.body=this.toFormData(n.body);break;case"bin":n.headers["Content-Type"]=n.headers["Content-Type"]||"application/octet-stream",n.body=n.body;break;default:return console.warn("tipo di contenuto non gestito."),null}let c=await fetch(`${Te.origin}${a}`,n);if(!c.ok){let i={status:c.status,status_text:c.statusText,error:(await c.json()).error};return console.warn("errore nella fetch:",i),w.recent=i,console.error(i),null}let f=null;switch(o.return_type){case"text":f=await c.text();break;case"json":f=await c.json();break;case"binario":f=await c.arrayBuffer();break;default:f=null,console.warn("tipo di dato non supportato.");break}return f}catch(s){return console.warn("fetch error: ",s),null}}static toFormData(a){let n=new FormData;for(let o in a)a.hasOwnProperty(o)&&n.append(o,a[o]);return n}};var Pe=class{static async get_auth_data(){let a=await pe.fetch("/auth/passkey/",{method:"GET"});if(!a)return!1;let{request_id:n,challenge:o,credentials_id:s}=a,c=q.base64.decode(o),f=null;s instanceof Array&&s.length>0&&(f=s.map(l=>({type:"public-key",id:q.base64.decode(l,!0),transports:["internal"]})));let i={challenge:c,userVerification:"preferred",timeout:6e4};f&&(i.allowCredentials=f);let y=null;try{y=await navigator.credentials.get({publicKey:i})}catch(l){return console.warn("Passkey auth request Aborted",l),null}return{request_id:n,id:y.id,rawId:new Uint8Array(y.rawId),response:{authenticatorData:new Uint8Array(y.response.authenticatorData),clientDataJSON:new Uint8Array(y.response.clientDataJSON),signature:new Uint8Array(y.response.signature)},userHandle:y.response.clientDataJSON.userHandle}}static async authenticate(a){if(!a.endpoint)return!1;if(a.body&&(a.body.request_id||a.body.auth_data))throw new Error("Invalid options properties, request_id & auth_data can't be used in this context");let n=null,o=null,s=a.body??{},c=!!a.body?.bypassToken,f={method:"POST",...a};if(c===!1){if(n=await this.get_auth_data(),!n)return n;o=n.request_id,delete n.request_id,s={...s,request_id:o,auth_data:q.base64.encode(de.encode(n))}}let i=await pe.fetch(f.endpoint,{method:f.method,body:s,auth:"psk"});return i||!1}};var _e=class{static async init(a){let n=q.hex.decode(a),o=await ue.random_bytes(32);await Q.set("cke-localMaterial",o);let s=await this.deriveKey(n,o);return ne.set("cke-key",s),s}static async set(a=null){let n=await Pe.authenticate({endpoint:"/cke/set",body:{bypassToken:a}}),{basic:o,advanced:s}=n.new,c=q.hex.decode(o),f=q.hex.decode(s),i=ue.random_bytes(32);Q.set("cke-localMaterial",i);let y=await this.deriveKey(c,i),m=await this.deriveKey(f,i);return ne.set("cke-key-basic",y),ne.set("cke-key-advanced",m),{keyBasic:y,keyAdvanced:m}}static async getBasic(){let a=await Q.get("cke-localMaterial");if(!a)return console.log("No local material founded"),null;let n=await pe.fetch("/cke/get/basic",{method:"GET"});if(!n)return null;let o=q.hex.decode(n.material),s=await this.deriveKey(o,a);return ne.set("cke-key-basic",s),s}static async getAdvanced(){let a=await Q.get("cke-localMaterial");if(!a)return console.log("No local material founded"),null;let n=await Pe.authenticate({endpoint:"/cke/get/advanced"});if(!n)return null;let o=q.hex.decode(n.key),s=await this.deriveKey(o,a);return ne.set("cke-key-advanced",s),s}static async deriveKey(a,n){return ue.HKDF(a,n)}};var Ue=class{static async init(){if(ne.get("shared-secret"))return console.log("Session already ok"),!0;let n=await _e.getBasic();if(!n)return!1;let o=await Q.get("shared-secret",n);return o?(ne.set("shared-secret",o),console.log("SHIV started"),this.startSession()):!1}static async startSession(a){return ne.get("master-key")!==null?0:(a||(a=await _e.getBasic()),a?await this.initSessionVariables(a):(console.log("CKE non ottenuta."),!1))}static async initSessionVariables(a){let n=await Q.get("master-key",a);if(!n)return!1;let o=await Q.get("salt",a),s=await Q.get("email-utente");return ne.set("cke-key-basic",a),ne.set("master-key",n),ne.set("salt",o),ne.set("email",s),!0}static async signin(a,n){let o=await Ae.generateKeyPair(),s=await pe.fetch("/auth/signin",{method:"POST",body:{email:a,password:n,publicKey:o}});if(!s)return!1;let{publicKey:c,bypassToken:f}=s,i=await Ae.completeHandshake(c);if(!i)return!1;let{keyBasic:y,keyAdvanced:m}=await _e.set(f);if(!y||!m)return!1;Q.set("shared-secret",i,y);let l=q.hex.decode(s.salt),d=await ue.deriveKey(n,l);return await Q.set("email-utente",a),await Q.set("password-utente",n,d),await Q.set("master-key",d,y),await Q.set("salt",l,y),ne.set("master-key",d),ne.set("salt",l),ne.set("uid",s.uid),!0}static async signout(){return await pe.fetch("/auth/signout",{method:"POST"})?(localStorage.clear(),sessionStorage.clear(),await chrome.storage.session.clear(),!0):!1}};var xe=class{static async save(a,n=null){await Q.set("vaults",a,n)}static async get(a=null){return await Q.get("vaults",a)??[]}static delete(a,n=null){let o=this.get(n),s=this.get_index(o,a);o.splice(s,1),this.save(o)}static get_index(a,n){return a.findIndex(o=>o.id===n)}static async sync_update(a,n){let o=await this.get(n);for(let s of a){let c=this.get_index(o,s.id);c!==-1?o[c]=s:o.push(s)}return await this.save(o,n),o}static update(a,n){let o=a.id,s=this.get(n),c=this.get_index(s,o);return c!==-1?s.push(a):s[c]=a,this.save(s),!0}};var Be=class w{static master_key=null;static salt=null;static vaults=[];static getDateDiff=30*60*1e3;static async init(a=!1){if(!await w.configSecrets())return!1;let o=await w.syncronize(a);return o&&(console.log("Vault initialized"),await chrome.storage.session.set({vaults:w.vaults}),!0)}static async configSecrets(){let a=ne.get("cke-key-basic");return a===null?!1:(this.master_key=await Q.get("master-key",a),this.salt=await Q.get("salt",a),!!(this.master_key&&this.salt))}static async syncronize(a=!1){if(!await this.configSecrets()||!this.master_key)return alert("Any Crypto Key founded");let o=await Q.get("vault-update")??null,s=null;o&&(s=new Date(Date.now()-this.getDateDiff)),this.vaults=[];try{this.vaults=await xe.get(this.master_key)}catch(c){console.log("[X] Errore crittografico localstorage",c),console.log("[i] Sincronizzo completamente con il vault"),a=!0}try{if(!a){let f=this.vaults.length,i=await this.count();f>i&&(a=!0)}let c=await this.get(a?null:s);c.length>0?a?(await xe.save(c,this.master_key),this.vaults=c):this.vaults=await xe.sync_update(c,this.master_key):a&&await xe.save([],this.master_key)}catch(c){return console.warn("Sync Error - Vault => ",c),Q.remove("vault-update"),Q.remove("vaults"),!1}return!0}static async get(a=null){let n="/vaults";a&&(n+=`?updated_after=${a.toISOString()}`);let o=await pe.fetch(n,{method:"GET"});return o?(o.length>0&&Q.set("vault-update",new Date),await this.decrypt_vaults(o)?o:null):null}static async count(){let a=await pe.fetch("/vaults/count",{method:"GET"});return a?a.count:0}static get_vault(a){return this.vaults[this.get_index(a)]}static get_index(a,n=this.vaults){return n.findIndex(o=>o.id===a)}static async encrypt(a,n=null,o=this.master_key){let s=n||ue.random_bytes(16),c=await ue.hmac(s,o),f=de.encode(a),i=await Ee.encrypt(f,c);return q.merge([s,i],8)}static async decrypt(a,n=this.master_key){let o=a.subarray(0,16),s=a.subarray(16),c=await ue.hmac(o,n),f=await Ee.decrypt(s,c);return de.decode(f)}static compact_vaults(a=this.vaults){return a.map(n=>{let{secrets:o,createdAt:s,updatedAt:c}=n;return{S:o,C:s,U:c}})}static decompact_vaults(a){return a.map(n=>{let{S:o,C:s,U:c}=n;return{secrets:o,createdAt:s,updatedAt:c}})}static async encrypt_vaults(a){let n=0;try{for(n=0;n<a.length;n++){let o=await this.encrypt(a[n]);a[n].secrets=o}}catch(o){return console.warn(`Decrypt Vault error at i = ${n}:`,o),!1}return!0}static async decrypt_vaults(a){if(!(a instanceof Array)||a.length===0)return!0;let n=0;try{for(n=0;n<a.length;n++){let o=new Uint8Array(a[n].secrets.data),s=await this.decrypt(o);a[n].secrets=s}}catch(o){return console.warn(`Decrypt Vault error at i = ${n}:`,o),!1}return!0}static async sendVaultToBackground(){return new Promise(a=>{chrome.runtime.sendMessage({type:"store-vault",payload:this.vaults},n=>{a(!!n?.success)})})}static async checkVaultStatus(){return new Promise(a=>{chrome.runtime.sendMessage({type:"check-vault-status"},n=>{a(!!n?.hasVault)})})}};window.VaultService=Be;document.addEventListener("DOMContentLoaded",async()=>{await Ue.init()?(Re.init(),Be.init()):document.querySelector("#signin").addEventListener("submit",async a=>{a.preventDefault();let n=document.getElementById("email").value,o=document.getElementById("password").value;await Ue.signin(n,o)&&(a.target.reset(),Re.init(),Be.init())}),document.getElementById("logout-btn").addEventListener("click",async()=>{confirm("Signout?")&&(await Ue.signout(),Re.init(!0))})});var Re=class{static async init(a=!1){document.querySelector("#signin").style.display=a?"":"none",document.querySelector("#app").style.display=a?"none":"";let n=await Q.get("email-utente");n&&(document.querySelector("#user-email").textContent=n.split("@")[0])}};})();
